<!DOCTYPE html>
<html>
  <head>
    <link href="/assets/styles.css" rel = "stylesheet" type="text/css"/>
    <link rel="FaviconIcon" href="favicon.ico" type="assets/nodejs">

    <meta charset="utf-8" http-equiv="refresh" content="20">
    <title>IoT2040</title>
    <!-- 引入 echarts.js -->
     <script src="http://echarts.baidu.com/dist/echarts.min.js"></script>
  </head>


  <body style="height: 100%; margin: 0">

    <h1>基于云平台的工业物联网设备检测系统</h1>
    <br></br>

    <!-- <ul>
      <% data.humidity_data.forEach(function(item){%>
        <li><%= item %></li>
      <%});%>
    </ul> -->
    <form id = "contact-form">
      <label for = "Who">温度</label>
      <input type="text" name = "who" value="<%= data.history_temp[0] %>">
      <label for = "Who">时间</label>
      <input type="text" name = "who" value="<%= data.temp_data[0] %>">
      <label for="department">湿度</label>
      <input type="text" name="department" value="<%= data.history_humidity[0] %>">
      <label for = "Who">时间</label>
      <input type="text" name = "who" value="<%= data.humidity_data[0] %>">

    </form>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<!-- <script>

$.getJSON('/iot2040',function(data){
    //regex time
  const regex = /^[0-9]{4}\-(?:0[1-9]|1[0-2])\-(?:0[1-9]|[1-2][0-9]|3[0-1])\s+(?:2[0-3]|[0-1][0-9]):[0-5][0-9]:[0-5][0-9]$/gm;
  var time = <%- JSON.stringify(data.time)%>;
  let m;

  while ((m = regex.exec(time)) !== null) {
      // This is necessary to avoid infinite loops with zero-width matches
      if (m.index === regex.lastIndex) {
          regex.lastIndex++;
      }

      // The result can be accessed through the `m`-variable.
      m.forEach((match, groupIndex) => {
          console.log(`Found match, group ${groupIndex}: ${match}`);
      });
  }
});

  </script> -->
      <br></br>
          <br></br>

         <div id="container" style="width: 600px;height:400px;"></div>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
         <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>


         <script type="text/javascript">



        var dom = document.getElementById("container");
        var myChart = echarts.init(dom);
        var app = {};
        var time = <%- JSON.stringify(data.temp_data)%>;





        option = null;
        option = {
            xAxis: {
                type: 'category',
                data:time

            },
            yAxis: {
                type: 'value'
            },
            series: [{
                data: [<%=data.history_temp %>],
                type: 'line'
            }],
            title: {
             left: 'center',
             text: '历史温度',
         }
        };

        if (option && typeof option === "object") {
            myChart.setOption(option, true);
        }
         </script>

         <div id="humidity" style="width: 600px;height:400px;"></div>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
         <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>


         <script type="text/javascript">



          var dom = document.getElementById("humidity");
          var myChart = echarts.init(dom);
          var app = {};
          var time = <%- JSON.stringify(data.humidity_data)%>;





          option = null;
          option = {
              xAxis: {
                  type: 'category',
                  data:time

              },
              yAxis: {
                  type: 'value'
              },
              series: [{
                  data: [<%=data.history_humidity %>],
                  type: 'line'
              }],
              title: {
               left: 'center',
               text: '历史湿度',
           }
          };

          if (option && typeof option === "object") {
              myChart.setOption(option, true);
          }
         </script>





         <div id="status" style="width: 300px;height:200px;"></div>
               <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
               <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
               <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
               <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
               <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
               <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
               <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
               <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
               <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>
               <script type="text/javascript">
        var dom = document.getElementById("status");
        var myChart = echarts.init(dom);
        var app = {};
        option = null;
        option = {
            title: {
                text: 'pin13 状态'
            },
            tooltip: {
                trigger: 'axis'
            },

            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },

            xAxis: {
                type: 'category',
                data: <%- JSON.stringify(data.status_data)%>
            },
            yAxis: {
                type: 'value'
            },
            series: [


                {
                    name:'Step End',
                    type:'line',
                    step: 'end',
                    data:[<%=data.status %>]
                }
            ]
        };
        ;
        if (option && typeof option === "object") {
            myChart.setOption(option, true);
        }
               </script>



          
     </body>
</html>
