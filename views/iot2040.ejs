<!DOCTYPE html>
<html>
  <head>
    <link href="/assets/styles.css" rel = "stylesheet" type="text/css"/>
    <link rel="FaviconIcon" href="favicon.ico" type="assets/nodejs">

    <meta charset="utf-8" http-equiv="refresh" content="20">
    <title>IoT2040</title>
    <!-- 引入 echarts.js -->
     <script src="http://echarts.baidu.com/dist/echarts.min.js"></script>
  </head>


  <body style="height: 100%; margin: 0">

    <h1>Contact Me</h1>
    <p>You wont find a website better anywhere else!</p>

    <ul>
      <% data.time.forEach(function(item){%>
        <li><%= item %></li>
      <%});%>
    </ul>
    <form id = "contact-form">
      <label for = "Who">温度</label>
      <input type="text" name = "who" value="<%= data.real_temp %>">
      <label for="department">湿度</label>
      <input type="text" name="department" value="<%= data.real_humidity %>">
      <label for="email">Your email</label>
      <input type="email" name="email"/>
      <input type="submit" value="submit"/>
    </form>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<!-- <script>

$.getJSON('/iot2040',function(data){
    //regex time
  const regex = /^[0-9]{4}\-(?:0[1-9]|1[0-2])\-(?:0[1-9]|[1-2][0-9]|3[0-1])\s+(?:2[0-3]|[0-1][0-9]):[0-5][0-9]:[0-5][0-9]$/gm;
  var time = <%- JSON.stringify(data.time)%>;
  let m;

  while ((m = regex.exec(time)) !== null) {
      // This is necessary to avoid infinite loops with zero-width matches
      if (m.index === regex.lastIndex) {
          regex.lastIndex++;
      }

      // The result can be accessed through the `m`-variable.
      m.forEach((match, groupIndex) => {
          console.log(`Found match, group ${groupIndex}: ${match}`);
      });
  }
});

  </script> -->
         <div id="container" style="width: 600px;height:400px;"></div>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
         <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>


         <script type="text/javascript">



  var dom = document.getElementById("container");
  var myChart = echarts.init(dom);
  var app = {};
  var time = <%- JSON.stringify(data.time)%>;





  option = null;
  option = {
      xAxis: {
          type: 'category',
          data:time

      },
      yAxis: {
          type: 'value'
      },
      series: [{
          data: [<%=data.history_temp %>],
          type: 'line'
      }],
      title: {
       left: 'center',
       text: '历史温度',
   }
  };

  if (option && typeof option === "object") {
      myChart.setOption(option, true);
  }
         </script>

         <div id="humidity" style="width: 600px;height:400px;"></div>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
         <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
         <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>


         <script type="text/javascript">



  var dom = document.getElementById("humidity");
  var myChart = echarts.init(dom);
  var app = {};
  var time = <%- JSON.stringify(data.time)%>;





  option = null;
  option = {
      xAxis: {
          type: 'category',
          data:time

      },
      yAxis: {
          type: 'value'
      },
      series: [{
          data: [<%=data.history_humidity %>],
          type: 'line'
      }],
      title: {
       left: 'center',
       text: '历史湿度',
   }
  };

  if (option && typeof option === "object") {
      myChart.setOption(option, true);
  }
         </script>
     </body>
</html>
